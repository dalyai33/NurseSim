name: Auto assign random reviewers
on:
  pull_request_target:
    types: [opened, reopened, ready_for_review, synchronize]

permissions:
  pull-requests: write

jobs:
  assign:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            const reviewers = [
              "dalyai33", "nisweesi", "franciscojmartinez12", "KianalShim", "Halei-6103" // <-- GitHub usernames here
            ];
            const author = context.payload.pull_request.user.login.toLowerCase();
            const pool = reviewers.filter(u => u.toLowerCase() !== author);

            const N = 1; // how many reviewers to pick
            for (let i = pool.length - 1; i > 0; i--) {
              const j = Math.floor(Math.random() * (i + 1));
              [pool[i], pool[j]] = [pool[j], pool[i]];
            }
            const chosen = pool.slice(0, N);

            if (chosen.length) {
              await github.rest.pulls.requestReviewers({
                owner: context.repo.owner,
                repo: context.repo.repo,
                pull_number: context.payload.pull_request.number,
                reviewers: chosen
              });
            }
